// -*- tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 2 -*-
// vi: set et ts=4 sw=2 sts=2:
/****************************************************************************/
/*                                                                          */
/* File:      quadrature.c                                                  */
/*                                                                          */
/* Purpose:   quadrature formulas                                               */
/*                                                                          */
/* Author:	  Christian Wieners                                                                             */
/*			  Institut fuer Computeranwendungen III                                                 */
/*			  Universitaet Stuttgart										*/
/*			  Pfaffenwaldring 27											*/
/*			  70569 Stuttgart												*/
/*			  email: ug@ica3.uni-stuttgart.de							    */
/*																			*/
/* History:   Sep 25 95 begin                                                                           */
/*                                                                          */
/* Remarks:                                                                 */
/*                                                                          */
/****************************************************************************/

/****************************************************************************/
/*                                                                          */
/* include files                                                            */
/*            system include files                                          */
/*            application include files                                     */
/*                                                                          */
/****************************************************************************/

#include <stdlib.h>

#include "evm.h"
#include "shapes.h"
#include "quadrature.h"
#include "ugdevices.h"
#include "general.h"

/****************************************************************************/
/*                                                                          */
/* defines in the following order                                           */
/*                                                                          */
/*        compile time constants defining static data size (i.e. arrays)    */
/*        other constants                                                   */
/*        macros                                                            */
/*                                                                          */
/****************************************************************************/

/****************************************************************************/
/*                                                                          */
/* data structures used in this source file (exported data structures are   */
/*        in the corresponding include file!)                               */
/*                                                                          */
/****************************************************************************/

/****************************************************************************/
/*                                                                          */
/* definition of exported global variables                                  */
/*                                                                          */
/****************************************************************************/

/****************************************************************************/
/*                                                                          */
/* definition of variables global to this source file only (static!)        */
/*                                                                          */
/****************************************************************************/


/* RCS string */
static char RCS_ID("$Header$",UG_RCS_STRING);

/****************************************************************************/
/*                                                                          */
/* forward declarations of functions used before they are defined           */
/*                                                                          */
/****************************************************************************/

/****************************************************************************/
/*                                                                          */
/* Quadrature formulas                                                      */
/*                                                                          */
/****************************************************************************/

/*--------------- 1D -------------------------------------------------------*/
/*
 * Gaussian quadrature abscissas and weights (from Mathematica, 64 digit precision).
 *
 * The errors are for a function f:

        -Derivative(2)(f)/24
        -0.000231*Derivative(4)(f)
        -4.960317e-7*Derivative(6)(f)
        -5.623942e-10*Derivative(8)(f)
        -3.944965e-13*Derivative(10)(f)
        -1.880943e-16*Derivative(12)(f)
        -6.492408e-20*Derivative(14)(f)
        -1.697361e-23*Derivative(16)(f)
        -3.477566e-27*Derivative(18)(f)
        -5.734017e-31*Derivative(20)(f)

 * Quadrature1Dn means, that the Quadrature rule is exact for polynomials up
 * to degree n.
 */
/* Degree 1 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D1_l[] = {{0.5, 0.0}};
static const DOUBLE Quadrature1D1_w[] = {1.0};
static QUADRATURE Quadrature1D1 = {1, 1, Quadrature1D1_l, Quadrature1D1_w};

/* Degree 3 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D3_l[] = {
  { 0.2113248654051871177454256097490212721761991243649365619906988367580112, 0.0 },
  { 0.7886751345948128822545743902509787278238008756350634380093011632419888, 0.0 }
};
static const DOUBLE Quadrature1D3_w[] = {
  0.5,
  0.5
};
static QUADRATURE Quadrature1D3 = {2, 3, Quadrature1D3_l, Quadrature1D3_w};

/* Degree 4 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D5_l[] = {
  {0.112701665379258311482073460021760038916707829470840917341242623388652 , 0.0 },
  {0.5 , 0.0 },
  {0.887298334620741688517926539978239961083292170529159082658757376611348 , 0.0 }
};
static const DOUBLE Quadrature1D5_w[] = {
  0.277777777777777777777777777777777777777777777777777777777777777777778,
  0.444444444444444444444444444444444444444444444444444444444444444444444,
  0.277777777777777777777777777777777777777777777777777777777777777777778
};
static QUADRATURE Quadrature1D5 = {3, 5, Quadrature1D5_l, Quadrature1D5_w};

/* Degree 7 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D7_l[] = {
  {0.069431844202973712388026755553595247452137310185141181192139039546735,  0.0},
  {0.3300094782075718675986671204483776563997120651145428237035230115894900, 0.0},
  {0.6699905217924281324013328795516223436002879348854571762964769884105100, 0.0},
  {0.930568155797026287611973244446404752547862689814858818807860960453265,  0.0}
};
static const DOUBLE Quadrature1D7_w[] = {
  0.173927422568726928686531974610999703617674347916946770246264659759376,
  0.326072577431273071313468025389000296382325652083053229753735340240624,
  0.326072577431273071313468025389000296382325652083053229753735340240624,
  0.173927422568726928686531974610999703617674347916946770246264659759376
};
static QUADRATURE Quadrature1D7 = {4, 7, Quadrature1D7_l, Quadrature1D7_w};

/* Degree 9 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D9_l[] = {
  {0.046910077030668003601186560850303517437174044618734568563118856728115,  0.0},
  {0.2307653449471584544818427896498955975163566965472200218988841864702644, 0.0},
  {0.5, 0.0},
  {0.7692346550528415455181572103501044024836433034527799781011158135297356, 0.0},
  {0.953089922969331996398813439149696482562825955381265431436881143271885,  0.0}
};
static const DOUBLE Quadrature1D9_w[] = {
  0.118463442528094543757132020359958681321630001106207007791413944110859,
  0.239314335249683234020645757417819096456147776671570769986363833666919,
  0.284444444444444444444444444444444444444444444444444444444444444444444,
  0.239314335249683234020645757417819096456147776671570769986363833666919,
  0.118463442528094543757132020359958681321630001106207007791413944110859
};
static QUADRATURE Quadrature1D9 = {5, 9, Quadrature1D9_l, Quadrature1D9_w};

/* Degree 11 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D11_l[] = {
  {0.033765242898423986093849222753002695432617131143855087563725191736693,  0.0},
  {0.1693953067668677431693002024900473264967757178024149645927366470739083, 0.0},
  {0.3806904069584015456847491391596440322906946849299893249093024177128625, 0.0},
  {0.6193095930415984543152508608403559677093053150700106750906975822871375, 0.0},
  {0.8306046932331322568306997975099526735032242821975850354072633529260917, 0.0},
  {0.966234757101576013906150777246997304567382868856144912436274808263307,  0.0}
};
static const DOUBLE Quadrature1D11_w[] = {
  0.085662246189585172520148071086366446763411250742021991199317719899473,
  0.180380786524069303784916756918858055830760946373372741144869620118570,
  0.233956967286345523694935171994775497405827802884605267655812659981957,
  0.233956967286345523694935171994775497405827802884605267655812659981957,
  0.180380786524069303784916756918858055830760946373372741144869620118570,
  0.085662246189585172520148071086366446763411250742021991199317719899473
};
static QUADRATURE Quadrature1D11 = {6, 11, Quadrature1D11_l, Quadrature1D11_w};

/* Degree 13 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D13_l[] = {
  {0.025446043828620737736905157976074368799614531164691108225615448043468, 0.0},
  {0.129234407200302780068067613359605796462926176429304869940022324016285,  0.0},
  {0.2970774243113014165466967939615192683263089929503149368064783741026681, 0.0},
  {0.5, 0.0},
  {0.7029225756886985834533032060384807316736910070496850631935216258973319, 0.0},
  {0.870765592799697219931932386640394203537073823570695130059977675983715,  0.0},
  {0.974553956171379262263094842023925631200385468835308891774384551956532,  0.0}
};
static const DOUBLE Quadrature1D13_w[] = {
  0.064742483084434846635305716339541009164293701129973331988604319362328,
  0.139852695744638333950733885711889791243462532613299382268507016346809,
  0.190915025252559472475184887744487566939182541766931367375541725515353,
  0.208979591836734693877551020408163265306122448979591836734693877551020,
  0.190915025252559472475184887744487566939182541766931367375541725515353,
  0.139852695744638333950733885711889791243462532613299382268507016346809,
  0.064742483084434846635305716339541009164293701129973331988604319362328
};
static QUADRATURE Quadrature1D13 = {7, 13, Quadrature1D13_l, Quadrature1D13_w};

/* Degree 15 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D15_l[] = {
  {0.019855071751231884158219565715263504785882382849273980864180111313788,  0.0},
  {0.101666761293186630204223031762084781581414134192017583964914852480391,  0.0},
  {0.2372337950418355070911304754053768254790178784398035711245714503637726, 0.0},
  {0.4082826787521750975302619288199080096666210935435131088414057631503978, 0.0},
  {0.5917173212478249024697380711800919903333789064564868911585942368496022, 0.0},
  {0.7627662049581644929088695245946231745209821215601964288754285496362274, 0.0},
  {0.898333238706813369795776968237915218418585865807982416035085147519609,  0.0},
  {0.980144928248768115841780434284736495214117617150726019135819888686212,  0.0}
};
static const DOUBLE Quadrature1D15_w[] = {
  0.050614268145188129576265677154981095057697045525842478529501849032370,
  0.111190517226687235272177997213120442215065435025624782362954644646808,
  0.156853322938943643668981100993300656630164499501367468845131972537478,
  0.181341891689180991482575224638597806097073019947165270262411533783343,
  0.181341891689180991482575224638597806097073019947165270262411533783343,
  0.156853322938943643668981100993300656630164499501367468845131972537478,
  0.111190517226687235272177997213120442215065435025624782362954644646808,
  0.050614268145188129576265677154981095057697045525842478529501849032370
};
static QUADRATURE Quadrature1D15 = {8, 15, Quadrature1D15_l, Quadrature1D15_w};

/* Degree 17 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D17_l[] = {
  {0.015919880246186955082211898548163564975297599754037335224988344075460, 0.0},
  {0.081984446336682102850285105965132561727946640937662001947814010180272,  0.0},
  {0.1933142836497048013456489803292629076071396975297176535635935288593663, 0.0},
  {0.3378732882980955354807309926783316957140218696315134555864762615789067, 0.0},
  {0.5, 0.0},
  {0.6621267117019044645192690073216683042859781303684865444135237384210933, 0.0},
  {0.8066857163502951986543510196707370923928603024702823464364064711406337, 0.0},
  {0.918015553663317897149714894034867438272053359062337998052185989819728,  0.0},
  {0.984080119753813044917788101451836435024702400245962664775011655924540,  0.0}
};
static const DOUBLE Quadrature1D17_w[] = {
  0.040637194180787205985946079055261825337830860391205375355553838440343,
  0.090324080347428702029236015621456404757168910866020242249167953235679,
  0.130305348201467731159371434709316424885920102218649975969998501059805,
  0.156173538520001420034315203292221832799377430630952322777005582799572,
  0.165119677500629881582262534643487024439405391786344167296548248929201,
  0.156173538520001420034315203292221832799377430630952322777005582799572,
  0.130305348201467731159371434709316424885920102218649975969998501059805,
  0.090324080347428702029236015621456404757168910866020242249167953235679,
  0.040637194180787205985946079055261825337830860391205375355553838440343
};
static QUADRATURE Quadrature1D17 = {9, 17, Quadrature1D17_l, Quadrature1D17_w};

/* Degree 19 ----------------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature1D19_l[] = {
  {0.013046735741414139961017993957773973285865026653808940384393966651702,  0.0},
  {0.067468316655507744633951655788253475736228492517334773739020134077313,  0.0},
  {0.160295215850487796882836317442563212115352644082595266167591405523721,  0.0},
  {0.2833023029353764046003670284171079188999640811718767517486492434281165, 0.0},
  {0.4255628305091843945575869994351400076912175702896541521460053732420482, 0.0},
  {0.5744371694908156054424130005648599923087824297103458478539946267579518, 0.0},
  {0.7166976970646235953996329715828920811000359188281232482513507565718835, 0.0},
  {0.839704784149512203117163682557436787884647355917404733832408594476279,  0.0},
  {0.932531683344492255366048344211746524263771507482665226260979865922687,  0.0},
  {0.986953264258585860038982006042226026714134973346191059615606033348298,  0.0}
};
static const DOUBLE Quadrature1D19_w[] = {
  0.033335672154344068796784404946665896428932417160079072564347440806706,
  0.074725674575290296572888169828848666201278319834713683917738634376619,
  0.109543181257991021997767467114081596229385935261338544940478271817600,
  0.134633359654998177545613460784734676429879969230441897900281638121077,
  0.147762112357376435086946497325669164710523358513426800677154014877998,
  0.147762112357376435086946497325669164710523358513426800677154014877998,
  0.134633359654998177545613460784734676429879969230441897900281638121077,
  0.109543181257991021997767467114081596229385935261338544940478271817600,
  0.074725674575290296572888169828848666201278319834713683917738634376619,
  0.033335672154344068796784404946665896428932417160079072564347440806706
};
static QUADRATURE Quadrature1D19 = {10, 19, Quadrature1D19_l, Quadrature1D19_w};



/*--------------- 2D -------------------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature2D31_l[] = {{0.333333333333333, 0.333333333333333}};
static const DOUBLE Quadrature2D31_w[] = {1.0};
static QUADRATURE Quadrature2D31 = {1, 1, Quadrature2D31_l, Quadrature2D31_w};

static const DOUBLE_VECTOR_3D Quadrature2D32_l[] = {{0.66666666666666666, 0.16666666666666666},
                                                    {0.16666666666666666, 0.66666666666666666},
                                                    {0.16666666666666666, 0.16666666666666666}};
static const DOUBLE Quadrature2D32_w[] = {0.333333333333333,    0.333333333333333,      0.333333333333333};
static QUADRATURE Quadrature2D32 = {3, 2, Quadrature2D32_l, Quadrature2D32_w};

static const DOUBLE_VECTOR_3D Quadrature2D33_l[] = {{0.333333333333333, 0.3333333333333333},
                                                    {0.6,0.2},
                                                    {0.2,0.6},
                                                    {0.2,0.2}};
static const DOUBLE Quadrature2D33_w[] = {-0.5625, 0.520833333333333, 0.520833333333333, 0.520833333333333};
static QUADRATURE Quadrature2D33 = {4, 3, Quadrature2D33_l, Quadrature2D33_w};

static const DOUBLE_VECTOR_3D Quadrature2D34_l[] = {{0.816847572980459, 0.091576213509771},
                                                    {0.091576213509771, 0.816847572980459},
                                                    {0.091576213509771, 0.091576213509771},
                                                    {0.108103018168070, 0.445948490915965},
                                                    {0.445948490915965, 0.108103018168070},
                                                    {0.445948490915965, 0.445948490915965}};
static const DOUBLE Quadrature2D34_w[] = {0.109951743655322, 0.109951743655322, 0.109951743655322,
                                          0.223381589678011, 0.223381589678011, 0.223381589678011};
static QUADRATURE Quadrature2D34 = {6, 4, Quadrature2D34_l, Quadrature2D34_w};

static const DOUBLE_VECTOR_3D Quadrature2D35_l[] = {{0.333333333333333, 0.333333333333333},
                                                    {0.059715871789770, 0.470142064105115},
                                                    {0.470142064105115, 0.059715871789770},
                                                    {0.470142064105115, 0.470142064105115},
                                                    {0.797426985368435,   0.101286507323456},
                                                    {0.101286507323456,   0.797426985368435},
                                                    {0.101286507323456,   0.101286507323456}};
static const DOUBLE Quadrature2D35_w[] = {0.225,
                                          0.132394152788506,
                                          0.132394152788506,
                                          0.132394152788506,
                                          0.125939180544827,
                                          0.125939180544827,
                                          0.125939180544827};
static QUADRATURE Quadrature2D35 = {7, 5, Quadrature2D35_l, Quadrature2D35_w};





static const DOUBLE_VECTOR_3D Quadrature2D36_l[] = {{0.333333333333333, 0.333333333333333},
                                                    {0.059715871789770, 0.470142064105115},
                                                    {0.470142064105115, 0.059715871789770},
                                                    {0.470142064105115, 0.470142064105115},
                                                    {0.797426985368435,   0.101286507323456},
                                                    {0.101286507323456,   0.797426985368435},
                                                    {0.101286507323456,   0.101286507323456}};
static const DOUBLE Quadrature2D36_w[] = {      0.116786275726379,
                                                0.116786275726379,
                                                0.116786275726379,
                                                0.050844906370207,
                                                0.050844906370207,
                                                0.050844906370207,
                                                0.082851075618374,
                                                0.082851075618374,
                                                0.082851075618374};
static QUADRATURE Quadrature2D36 = {7, 5, Quadrature2D36_l, Quadrature2D36_w};

/******** For new GaussQuadratureRule function *****************************/
/*
 * Many of these  quadrature formulas come from the
 * "Encyclopaedia of Cubature Formulas" at
 * http://www.cs.kuleuven.ac.be/~nines/research/ecf/ecf.html
 * maintained by Ronald Cools.
 *
 */


/* ---- Polynomial degree 1 --------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P1_N1_GP[] = {
  {0.333333333333333333333333333333333,
   0.333333333333333333333333333333333}
};

static const DOUBLE Quadrature2D_Triangle_P1_N1_W[] = {0.5};

static QUADRATURE Quadrature2D_Triangle_P1_N1 = {
  /* Number of Gauss Points */
  1,
  /* Polynomial degree */
  1,
  /* Abscissae */
  Quadrature2D_Triangle_P1_N1_GP,
  /* Weight */
  Quadrature2D_Triangle_P1_N1_W
};


/* ---- Polynomial degree 2 --------------------------------------------*/
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P2_N3a_GP[] = {
  {0.5, 0.5},
  {0.5, 0.0},
  {0.0, 0.5}
};

static const DOUBLE Quadrature2D_Triangle_P2_N3a_W[] =
{0.166666666666666666666666666666666,
 0.166666666666666666666666666666666,
 0.166666666666666666666666666666666};

static QUADRATURE Quadrature2D_Triangle_P2_N3a = {
  /* Number of Gauss Points */
  3,
  /* Polynomial degree */
  2,
  /* Abscissae */
  Quadrature2D_Triangle_P2_N3a_GP,
  /* Weight */
  Quadrature2D_Triangle_P2_N3a_W
};

static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P2_N3b_GP[] =
{{0.16666666666666666666666666666667, 0.16666666666666666666666666666667},
 {0.16666666666666666666666666666667, 0.66666666666666666666666666666667},
 {0.66666666666666666666666666666667, 0.16666666666666666666666666666667}};

static const DOUBLE Quadrature2D_Triangle_P2_N3b_W[] =
{0.166666666666666666666666666666666,
 0.166666666666666666666666666666666,
 0.166666666666666666666666666666666};

static QUADRATURE Quadrature2D_Triangle_P2_N3b = {
  /* Number of Gauss Points */
  3,
  /* Polynomial degree */
  2,
  /* Abscissae */
  Quadrature2D_Triangle_P2_N3b_GP,
  /* Weight */
  Quadrature2D_Triangle_P2_N3b_W
};



/* ---- Polynomial degree 3 --------------------------------------------*/

/* 4 Gauss points, 1 negative weight */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P3_N4_GP[] =
{{0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.2, 0.2, 0.6},
 {0.2, 0.6, 0.2},
 {0.6, 0.2, 0.2}};

static const DOUBLE Quadrature2D_Triangle_P3_N4_W[] =
{-0.28125,
 0.260416666666666666666666666666666,
 0.260416666666666666666666666666666,
 0.260416666666666666666666666666666};

static QUADRATURE Quadrature2D_Triangle_P3_N4 = {
  /* Number of Gauss Points */
  4,
  /* Polynomial degree */
  3,
  /* Abscissae */
  Quadrature2D_Triangle_P3_N4_GP,
  /* Weight */
  Quadrature2D_Triangle_P3_N4_W
};


/* 6 Gauss points, 3 points on boundary, 3 negative weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P3_N6a_GP[] =
{{0.0, 0.0},
 {1.0, 0.0},
 {0.0, 1.0},
 {0.14724747683480533311373176020907, 0.14724747683480533311373176020907},
 {0.14724747683480533311373176020907, 0.70550504633038933377253647958187},
 {0.70550504633038933377253647958187, 0.14724747683480533311373176020907}};

static const DOUBLE Quadrature2D_Triangle_P3_N6a_W[] =
{-0.0149273987289826666941168633072000,
 -0.0149273987289826666941168633072000,
 -0.0149273987289826666941168633072000,
 0.181594065395649333360783529973866,
 0.181594065395649333360783529973866,
 0.181594065395649333360783529973866};

static QUADRATURE Quadrature2D_Triangle_P3_N6a = {
  /* Number of Gauss Points */
  6,
  /* Polynomial degree */
  3,
  /* Abscissae */
  Quadrature2D_Triangle_P3_N6a_GP,
  /* Weight */
  Quadrature2D_Triangle_P3_N6a_W
};


/* 6 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P3_N6b_GP[] =
{{0.10903900907287721232483466756991, 0.23193336855303057249678456117469},
 {0.10903900907287721232483466756991, 0.65902762237409221517838077125540},
 {0.23193336855303057249678456117469, 0.10903900907287721232483466756991},
 {0.23193336855303057249678456117469, 0.65902762237409221517838077125540},
 {0.65902762237409221517838077125540, 0.10903900907287721232483466756991},
 {0.65902762237409221517838077125540, 0.23193336855303057249678456117469}};

static const DOUBLE Quadrature2D_Triangle_P3_N6b_W[] =
{0.0833333333333333333333333333333333,
 0.0833333333333333333333333333333333,
 0.0833333333333333333333333333333333,
 0.0833333333333333333333333333333333,
 0.0833333333333333333333333333333333,
 0.0833333333333333333333333333333333};

static QUADRATURE Quadrature2D_Triangle_P3_N6b = {
  /* Number of Gauss Points */
  6,
  /* Polynomial degree */
  3,
  /* Abscissae */
  Quadrature2D_Triangle_P3_N6b_GP,
  /* Weight */
  Quadrature2D_Triangle_P3_N6b_W
};

/* 3 inner Gauss points, 3 boundary Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P3_N6c_GP[] =
{{0.5, 0.5},
 {0.5, 0.0},
 {0.0, 0.5},
 {0.16666666666666666666666666666667, 0.16666666666666666666666666666667},
 {0.16666666666666666666666666666667, 0.66666666666666666666666666666667},
 {0.66666666666666666666666666666667, 0.16666666666666666666666666666667}};

static const DOUBLE Quadrature2D_Triangle_P3_N6c_W[] =
{0.0166666666666666666666666666666666,
 0.0166666666666666666666666666666666,
 0.0166666666666666666666666666666666,
 0.15,
 0.15,
 0.15};

static QUADRATURE Quadrature2D_Triangle_P3_N6c = {
  /* Number of Gauss Points */
  6,
  /* Polynomial degree */
  3,
  /* Abscissae */
  Quadrature2D_Triangle_P3_N6c_GP,
  /* Weight */
  Quadrature2D_Triangle_P3_N6c_W
};


/* 7 Gauss Points, 6 on boundary, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P3_N7_GP[] =
{{0.0, 0.0},
 {1.0, 0.0},
 {0.0, 1.0},
 {0.5, 0.5},
 {0.5, 0.0},
 {0.0, 0.5},
 {0.333333333333333333333333333333333, 0.333333333333333333333333333333333}};

static const DOUBLE Quadrature2D_Triangle_P3_N7_W[] =
{0.025,
 0.025,
 0.025,
 0.0666666666666666666666666666666666,
 0.0666666666666666666666666666666666,
 0.0666666666666666666666666666666666,
 0.225};

static QUADRATURE Quadrature2D_Triangle_P3_N7 = {
  /* Number of Gauss Points */
  7,
  /* Polynomial degree */
  3,
  /* Abscissae */
  Quadrature2D_Triangle_P3_N7_GP,
  /* Weight */
  Quadrature2D_Triangle_P3_N7_W
};


/* ---- Polynomial degree 4 --------------------------------------------*/

/* 6 inner points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P4_N6_GP[] =
{{0.091576213509770743459571463402202, 0.091576213509770743459571463402202},
 {0.091576213509770743459571463402202, 0.81684757298045851308085707319560},
 {0.81684757298045851308085707319560, 0.091576213509770743459571463402202},
 {0.44594849091596488631832925388305, 0.44594849091596488631832925388305},
 {0.44594849091596488631832925388305, 0.10810301816807022736334149223390},
 {0.10810301816807022736334149223390, 0.44594849091596488631832925388305}};

static const DOUBLE Quadrature2D_Triangle_P4_N6_W[] =
{0.0549758718276609338191631624501052,
 0.0549758718276609338191631624501052,
 0.0549758718276609338191631624501052,
 0.111690794839005732847503504216561,
 0.111690794839005732847503504216561,
 0.111690794839005732847503504216561};

static QUADRATURE Quadrature2D_Triangle_P4_N6 = {
  /* Number of Gauss Points */
  6,
  /* Polynomial degree */
  4,
  /* Abscissae */
  Quadrature2D_Triangle_P4_N6_GP,
  /* Weight */
  Quadrature2D_Triangle_P4_N6_W
};

/* 7 inner points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P4_N7_GP[] =
{{0.33333333333333333333333333333333,  0.33333333333333333333333333333333},
 {0.025355134559131751049580723682707, 0.23793236647243354549156299492765},
 {0.025355134559131751049580723682707, 0.73671249896843470345885628138964},
 {0.23793236647243354549156299492765,  0.025355134559131751049580723682707},
 {0.23793236647243354549156299492765,  0.73671249896843470345885628138964},
 {0.73671249896843470345885628138964,  0.025355134559131751049580723682707},
 {0.73671249896843470345885628138964,  0.23793236647243354549156299492765}};

static const DOUBLE Quadrature2D_Triangle_P4_N7_W[] =
{0.1875,
 0.0520833333333333333333333333333333,
 0.0520833333333333333333333333333333,
 0.0520833333333333333333333333333333,
 0.0520833333333333333333333333333333,
 0.0520833333333333333333333333333333,
 0.0520833333333333333333333333333333};

static QUADRATURE Quadrature2D_Triangle_P4_N7 = {
  /* Number of Gauss Points */
  7,
  /* Polynomial degree */
  4,
  /* Abscissae */
  Quadrature2D_Triangle_P4_N7_GP,
  /* Weight */
  Quadrature2D_Triangle_P4_N7_W
};

/* 9 Gauss points, 3 on boundary, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P4_N9_GP[] =
{{0.0, 0.0},
 {1.0, 0.0},
 {0.0, 1.0},
 {0.5, 0.5},
 {0.5, 0.0},
 {0.0, 0.5},
 {0.18858048469644503927115437402942, 0.18858048469644503927115437402942},
 {0.18858048469644503927115437402942, 0.62283903060710992145769125194117},
 {0.62283903060710992145769125194117, 0.18858048469644503927115437402942}};

static const DOUBLE Quadrature2D_Triangle_P4_N9_W[] =
{0.0102700676729666815373344149062909,
 0.0102700676729666815373344149062909,
 0.0102700676729666815373344149062909,
 0.0309877494341335712640173051673223,
 0.0309877494341335712640173051673223,
 0.0309877494341335712640173051673223,
 0.125408849559566413865314946593053,
 0.125408849559566413865314946593053,
 0.125408849559566413865314946593053};

static QUADRATURE Quadrature2D_Triangle_P4_N9 = {
  /* Number of Gauss Points */
  9,
  /* Polynomial degree */
  4,
  /* Abscissae */
  Quadrature2D_Triangle_P4_N9_GP,
  /* Weight */
  Quadrature2D_Triangle_P4_N9_W
};

/* ---- Polynomial degree 5 --------------------------------------------*/

/* 7 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P5_N7_GP[] =
{{0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.10128650732345633880098736191512, 0.10128650732345633880098736191512},
 {0.10128650732345633880098736191512, 0.79742698535308732239802527616975},
 {0.79742698535308732239802527616975, 0.10128650732345633880098736191512},
 {0.47014206410511508977044120951345, 0.47014206410511508977044120951345},
 {0.47014206410511508977044120951345, 0.05971587178976982045911758097311},
 {0.05971587178976982045911758097311, 0.47014206410511508977044120951345}};

static const DOUBLE Quadrature2D_Triangle_P5_N7_W[] =
{0.1125,
 0.0629695902724135762978419727500906,
 0.0629695902724135762978419727500906,
 0.0629695902724135762978419727500906,
 0.0661970763942530903688246939165759,
 0.0661970763942530903688246939165759,
 0.0661970763942530903688246939165759};

static QUADRATURE Quadrature2D_Triangle_P5_N7 = {
  /* Number of Gauss Points */
  7,
  /* Polynomial degree */
  5,
  /* Abscissae */
  Quadrature2D_Triangle_P5_N7_GP,
  /* Weight */
  Quadrature2D_Triangle_P5_N7_W
};

/* 9 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P7_N9_GP[] =
{{0.43752524838338386732523898110054, 0.43752524838338386732523898110054},
 {0.43752524838338386732523898110054, 0.12494950323323226534952203779891},
 {0.12494950323323226534952203779891, 0.43752524838338386732523898110054},
 {0.037477420750087775658575783340592, 0.16540992738984142292404701391079},
 {0.037477420750087775658575783340592, 0.79711265186007080141737720274862},
 {0.16540992738984142292404701391079, 0.037477420750087775658575783340592},
 {0.16540992738984142292404701391079, 0.79711265186007080141737720274862},
 {0.79711265186007080141737720274862, 0.037477420750087775658575783340592},
 {0.79711265186007080141737720274862, 0.16540992738984142292404701391079}};

static const DOUBLE Quadrature2D_Triangle_P7_N9_W[] =
{0.102975252380443301505922425064148,
 0.102975252380443301505922425064148,
 0.102975252380443301505922425064148,
 0.0318457071431116825803721208012591,
 0.0318457071431116825803721208012591,
 0.0318457071431116825803721208012591,
 0.0318457071431116825803721208012591,
 0.0318457071431116825803721208012591,
 0.0318457071431116825803721208012591};

static QUADRATURE Quadrature2D_Triangle_P7_N9 = {
  /* Number of Gauss Points */
  9,
  /* Polynomial degree */
  5,
  /* Abscissae */
  Quadrature2D_Triangle_P7_N9_GP,
  /* Weight */
  Quadrature2D_Triangle_P7_N9_W
};

/* ---- Polynomial degree 6 --------------------------------------------*/

/* 12 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P6_N12a_GP[] =
{{0.063089014491502228340331602870819, 0.063089014491502228340331602870819},
 {0.063089014491502228340331602870819, 0.87382197101699554331933679425836},
 {0.87382197101699554331933679425836, 0.063089014491502228340331602870819},
 {0.24928674517091042129163855310702, 0.24928674517091042129163855310702},
 {0.24928674517091042129163855310702, 0.50142650965817915741672289378596},
 {0.50142650965817915741672289378596, 0.24928674517091042129163855310702},
 {0.053145049844816947353249671631398, 0.31035245103378440541660773395655},
 {0.053145049844816947353249671631398, 0.63650249912139864723014259441205},
 {0.31035245103378440541660773395655, 0.053145049844816947353249671631398},
 {0.31035245103378440541660773395655, 0.63650249912139864723014259441205},
 {0.63650249912139864723014259441205, 0.053145049844816947353249671631398},
 {0.63650249912139864723014259441205, 0.31035245103378440541660773395655}};

static const DOUBLE Quadrature2D_Triangle_P6_N12a_W[] =
{0.0254224531851034084604684045534344,
 0.0254224531851034084604684045534344,
 0.0254224531851034084604684045534344,
 0.0583931378631896830126448056927897,
 0.0583931378631896830126448056927897,
 0.0583931378631896830126448056927897,
 0.0414255378091867875967767282102212,
 0.0414255378091867875967767282102212,
 0.0414255378091867875967767282102212,
 0.0414255378091867875967767282102212,
 0.0414255378091867875967767282102212,
 0.0414255378091867875967767282102212};

static QUADRATURE Quadrature2D_Triangle_P6_N12a = {
  /* Number of Gauss Points */
  12,
  /* Polynomial degree */
  6,
  /* Abscissae */
  Quadrature2D_Triangle_P6_N12a_GP,
  /* Weight */
  Quadrature2D_Triangle_P6_N12a_W
};

/* 12 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P6_N12b_GP[] =
{{0.21942998254978296000012662922294, 0.21942998254978296000012662922294},
 {0.21942998254978296000012662922294, 0.56114003490043407999974674155413},
 {0.56114003490043407999974674155413, 0.21942998254978296000012662922294},
 {0.48013796411221504402894153229550, 0.48013796411221504402894153229550},
 {0.48013796411221504402894153229550, 0.03972407177556991194211693540900},
 {0.03972407177556991194211693540900, 0.48013796411221504402894153229550},
 {0.83900925971479105320836760570047, 0.14161901592396815841177387638623},
 {0.83900925971479105320836760570047, 0.01937172436124078837985851791330},
 {0.14161901592396815841177387638623, 0.83900925971479105320836760570047},
 {0.14161901592396815841177387638623, 0.01937172436124078837985851791330},
 {0.01937172436124078837985851791330, 0.83900925971479105320836760570047},
 {0.01937172436124078837985851791330, 0.14161901592396815841177387638623}};

static const DOUBLE Quadrature2D_Triangle_P6_N12b_W[] =
{0.0856665620764905150601082944029099,
 0.0856665620764905150601082944029099,
 0.0856665620764905150601082944029099,
 0.0403655447965154891547968501068538,
 0.0403655447965154891547968501068538,
 0.0403655447965154891547968501068538,
 0.0203172798968303312258807610784514,
 0.0203172798968303312258807610784514,
 0.0203172798968303312258807610784514,
 0.0203172798968303312258807610784514,
 0.0203172798968303312258807610784514,
 0.0203172798968303312258807610784514};

static QUADRATURE Quadrature2D_Triangle_P6_N12b = {
  /* Number of Gauss Points */
  12,
  /* Polynomial degree */
  6,
  /* Abscissae */
  Quadrature2D_Triangle_P6_N12b_GP,
  /* Weight */
  Quadrature2D_Triangle_P6_N12b_W
};

/* 13 Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P6_N13_GP[] =
{{0.865307354083457174835799758111522, 0.134692645916542825164200241888477},
 {0.865307354083457174835799758111522, 0.0},
 {0.134692645916542825164200241888477, 0.865307354083457174835799758111522},
 {0.134692645916542825164200241888477, 0.0},
 {0.0,                                 0.865307354083457174835799758111522},
 {0.0,                                 0.134692645916542825164200241888477},
 {0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.47383081395365138455265792772597,  0.47383081395365138455265792772597},
 {0.47383081395365138455265792772597,  0.05233837209269723089468414454806},
 {0.05233837209269723089468414454806,  0.47383081395365138455265792772597},
 {0.17211766963081763562155759271492,  0.17211766963081763562155759271492},
 {0.17211766963081763562155759271492,  0.65576466073836472875688481457017},
 {0.65576466073836472875688481457017,  0.17211766963081763562155759271492}};

static const DOUBLE Quadrature2D_Triangle_P6_N13_W[] =
{0.0136815117610912358383585755794295,
 0.0136815117610912358383585755794295,
 0.0136815117610912358383585755794295,
 0.0136815117610912358383585755794295,
 0.0136815117610912358383585755794295,
 0.0136815117610912358383585755794295,
 0.0763544833941761678092794499977435,
 0.0490679340394458991593154855637657,
 0.0490679340394458991593154855637657,
 0.0490679340394458991593154855637657,
 0.0647842146403129065608742132781272,
 0.0647842146403129065608742132781272,
 0.0647842146403129065608742132781272};

static QUADRATURE Quadrature2D_Triangle_P6_N13 = {
  /* Number of Gauss Points */
  13,
  /* Polynomial degree */
  6,
  /* Abscissae */
  Quadrature2D_Triangle_P6_N13_GP,
  /* Weight */
  Quadrature2D_Triangle_P6_N13_W
};


/* ---- Polynomial degree 7 --------------------------------------------*/

/* 12 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P7_N12_GP[] =
{{0.0623822650944021181736830009963499, 0.0675178670739160854425571310508685},
 {0.0675178670739160854425571310508685, 0.870099867831681796383759867952782},
 {0.870099867831681796383759867952782,  0.0623822650944021181736830009963499},
 {0.0552254566569266117374791902756449, 0.321502493851981822666307849199202},
 {0.321502493851981822666307849199202,  0.623272049491091565596212960525153},
 {0.623272049491091565596212960525153,  0.0552254566569266117374791902756449},
 {0.0343243029450971464696306424839376, 0.660949196186735657611980310197799},
 {0.660949196186735657611980310197799,  0.304726500868167195918389047318263},
 {0.304726500868167195918389047318263,  0.0343243029450971464696306424839376},
 {0.515842334353591779257463386826430,  0.277716166976391782569581871393723},
 {0.277716166976391782569581871393723,  0.20644149867001643817295474177985},
 {0.20644149867001643817295474177985,   0.515842334353591779257463386826430}};

static const DOUBLE Quadrature2D_Triangle_P7_N12_W[] =
{0.0265170281574362514287541804607391,
 0.0265170281574362514287541804607391,
 0.0265170281574362514287541804607391,
 0.0438814087144460550367699031392875,
 0.0438814087144460550367699031392875,
 0.0438814087144460550367699031392875,
 0.0287750427849815857384454969002185,
 0.0287750427849815857384454969002185,
 0.0287750427849815857384454969002185,
 0.0674931870098027744626970861664214,
 0.0674931870098027744626970861664214,
 0.0674931870098027744626970861664214};

static QUADRATURE Quadrature2D_Triangle_P7_N12 = {
  /* Number of Gauss Points */
  12,
  /* Polynomial degree */
  7,
  /* Abscissae */
  Quadrature2D_Triangle_P7_N12_GP,
  /* Weight */
  Quadrature2D_Triangle_P7_N12_W
};

/* 13 inner Gauss points, one negative weight */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P7_N13_GP[] =
{{0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.26034596607903982692624246913924, 0.26034596607903982692624246913924},
 {0.26034596607903982692624246913924, 0.47930806784192034614751506172153},
 {0.47930806784192034614751506172153, 0.26034596607903982692624246913924},
 {0.065130102902215811538025906311975, 0.065130102902215811538025906311975},
 {0.065130102902215811538025906311975, 0.86973979419556837692394818737605},
 {0.86973979419556837692394818737605, 0.065130102902215811538025906311975},
 {0.048690315425316411793021558528413, 0.31286549600487386140664447676840},
 {0.048690315425316411793021558528413, 0.63844418856980972680033396470319},
 {0.31286549600487386140664447676840, 0.048690315425316411793021558528413},
 {0.31286549600487386140664447676840, 0.63844418856980972680033396470319},
 {0.63844418856980972680033396470319, 0.048690315425316411793021558528413},
 {0.63844418856980972680033396470319, 0.31286549600487386140664447676840}};

static const DOUBLE Quadrature2D_Triangle_P7_N13_W[] =
{-0.0747850222338408753148556277365486,
 0.0878076287166039058767597055781635,
 0.0878076287166039058767597055781635,
 0.0878076287166039058767597055781635,
 0.0266736178044192456349936444495335,
 0.0266736178044192456349936444495335,
 0.0266736178044192456349936444495335,
 0.0385568804451285701299325962755762,
 0.0385568804451285701299325962755762,
 0.0385568804451285701299325962755762,
 0.0385568804451285701299325962755762,
 0.0385568804451285701299325962755762,
 0.0385568804451285701299325962755762};

static QUADRATURE Quadrature2D_Triangle_P7_N13 = {
  /* Number of Gauss Points */
  13,
  /* Polynomial degree */
  7,
  /* Abscissae */
  Quadrature2D_Triangle_P7_N13_GP,
  /* Weight */
  Quadrature2D_Triangle_P7_N13_W
};

static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P7_N15_GP[] =
{{0.064930513159164863078379776030397, 0.064930513159164863078379776030397},
 {0.064930513159164863078379776030397, 0.87013897368167027384324044793921},
 {0.87013897368167027384324044793921,  0.064930513159164863078379776030397},
 {0.19838447668150671917987659863333,  0.51703993906932294562270734401689},
 {0.19838447668150671917987659863333,  0.28457558424917033519741605734978},
 {0.51703993906932294562270734401689,  0.19838447668150671917987659863333},
 {0.51703993906932294562270734401689,  0.28457558424917033519741605734978},
 {0.28457558424917033519741605734978,  0.19838447668150671917987659863333},
 {0.28457558424917033519741605734978,  0.51703993906932294562270734401689},
 {0.64257734382269602053234940183007,  0.043863471792372471511798695971296},
 {0.64257734382269602053234940183007,  0.31355918438493150795585190219863},
 {0.043863471792372471511798695971296, 0.64257734382269602053234940183007},
 {0.043863471792372471511798695971296, 0.31355918438493150795585190219863},
 {0.31355918438493150795585190219863,  0.64257734382269602053234940183007},
 {0.31355918438493150795585190219863,  0.043863471792372471511798695971296}};

static const DOUBLE Quadrature2D_Triangle_P7_N15_W[] =
{0.0265389008951162058359774874998477,
 0.0265389008951162058359774874998477,
 0.0265389008951162058359774874998477,
 0.0354265418460667836592062916232018,
 0.0354265418460667836592062916232018,
 0.0354265418460667836592062916232018,
 0.0354265418460667836592062916232018,
 0.0354265418460667836592062916232018,
 0.0354265418460667836592062916232018,
 0.0346373410397084467561382979602076,
 0.0346373410397084467561382979602076,
 0.0346373410397084467561382979602076,
 0.0346373410397084467561382979602076,
 0.0346373410397084467561382979602076,
 0.0346373410397084467561382979602076};

static QUADRATURE Quadrature2D_Triangle_P7_N15 = {
  /* Number of Gauss Points */
  15,
  /* Polynomial degree */
  7,
  /* Abscissae */
  Quadrature2D_Triangle_P7_N15_GP,
  /* Weights */
  Quadrature2D_Triangle_P7_N15_W
};


/* ---- Polynomial degree 8 --------------------------------------------*/

/* 16 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P8_N16_GP[] =
{{0.33333333333333333333333333333333,  0.33333333333333333333333333333333},
 {0.17056930775176020662229350149146,  0.17056930775176020662229350149146},
 {0.17056930775176020662229350149146,  0.65886138449647958675541299701707},
 {0.65886138449647958675541299701707,  0.17056930775176020662229350149146},
 {0.050547228317030975458423550596599, 0.050547228317030975458423550596599},
 {0.050547228317030975458423550596599, 0.89890554336593804908315289880680},
 {0.89890554336593804908315289880680,  0.050547228317030975458423550596599},
 {0.45929258829272315602881551449417,  0.45929258829272315602881551449417},
 {0.45929258829272315602881551449417,  0.08141482341455368794236897101166},
 {0.08141482341455368794236897101166,  0.45929258829272315602881551449417},
 {0.72849239295540428124100037917606,  0.26311282963463811342178578628464},
 {0.72849239295540428124100037917606,  0.00839477740995760533721383453930},
 {0.26311282963463811342178578628464,  0.72849239295540428124100037917606},
 {0.26311282963463811342178578628464,  0.00839477740995760533721383453930},
 {0.00839477740995760533721383453930,  0.72849239295540428124100037917606},
 {0.00839477740995760533721383453930,  0.26311282963463811342178578628464}};

static const DOUBLE Quadrature2D_Triangle_P8_N16_W[] =
{0.0721578038388935841255455552445323,
 0.0516086852673591251408957751460645,
 0.0516086852673591251408957751460645,
 0.0516086852673591251408957751460645,
 0.0162292488115990401554629641708902,
 0.0162292488115990401554629641708902,
 0.0162292488115990401554629641708902,
 0.0475458171336423123969480521942921,
 0.0475458171336423123969480521942921,
 0.0475458171336423123969480521942921,
 0.0136151570872174971324223450369544,
 0.0136151570872174971324223450369544,
 0.0136151570872174971324223450369544,
 0.0136151570872174971324223450369544,
 0.0136151570872174971324223450369544,
 0.0136151570872174971324223450369544};

static QUADRATURE Quadrature2D_Triangle_P8_N16 = {
  /* Number of Gauss Points */
  16,
  /* Polynomial degree */
  8,
  /* Abscissae */
  Quadrature2D_Triangle_P8_N16_GP,
  /* Weight */
  Quadrature2D_Triangle_P8_N16_W
};

/* ---- Polynomial degree 9 --------------------------------------------*/

/* 19 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P9_N19_GP[] =
{{0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.48968251919873762778370692483619,  0.48968251919873762778370692483619},
 {0.48968251919873762778370692483619,  0.02063496160252474443258615032762},
 {0.02063496160252474443258615032762,  0.48968251919873762778370692483619},
 {0.43708959149293663726993036443535,  0.43708959149293663726993036443535},
 {0.43708959149293663726993036443535,  0.12582081701412672546013927112929},
 {0.12582081701412672546013927112929,  0.43708959149293663726993036443535},
 {0.18820353561903273024096128046733,  0.18820353561903273024096128046733},
 {0.18820353561903273024096128046733,  0.62359292876193453951807743906533},
 {0.62359292876193453951807743906533,  0.18820353561903273024096128046733},
 {0.044729513394452709865106589966276, 0.044729513394452709865106589966276},
 {0.044729513394452709865106589966276, 0.91054097321109458026978682006745},
 {0.91054097321109458026978682006745,  0.044729513394452709865106589966276},
 {0.74119859878449802069007987352342,  0.036838412054736283634817598783385},
 {0.74119859878449802069007987352342,  0.22196298916076569567510252769319},
 {0.036838412054736283634817598783385, 0.74119859878449802069007987352342},
 {0.036838412054736283634817598783385, 0.22196298916076569567510252769319},
 {0.22196298916076569567510252769319,  0.74119859878449802069007987352342},
 {0.22196298916076569567510252769319,  0.036838412054736283634817598783385}};

static const DOUBLE Quadrature2D_Triangle_P9_N19_W[] =
{0.0485678981413994169096209912536443,
 0.0156673501135695352684274156436046,
 0.0156673501135695352684274156436046,
 0.0156673501135695352684274156436046,
 0.0389137705023871396583696781497019,
 0.0389137705023871396583696781497019,
 0.0389137705023871396583696781497019,
 0.0398238694636051265164458871320226,
 0.0398238694636051265164458871320226,
 0.0398238694636051265164458871320226,
 0.0127888378293490156308393992794999,
 0.0127888378293490156308393992794999,
 0.0127888378293490156308393992794999,
 0.0216417696886446886446886446886446,
 0.0216417696886446886446886446886446,
 0.0216417696886446886446886446886446,
 0.0216417696886446886446886446886446,
 0.0216417696886446886446886446886446,
 0.0216417696886446886446886446886446};

static QUADRATURE Quadrature2D_Triangle_P9_N19 = {
  /* Number of Gauss Points */
  19,
  /* Polynomial degree */
  9,
  /* Abscissae */
  Quadrature2D_Triangle_P9_N19_GP,
  /* Weight */
  Quadrature2D_Triangle_P9_N19_W
};

/* ---- Polynomial degree 10 --------------------------------------------*/

/* 25 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P10_N25a_GP[] =
{{0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.42508621060209057296952951163804, 0.42508621060209057296952951163804},
 {0.42508621060209057296952951163804, 0.14982757879581885406094097672391},
 {0.14982757879581885406094097672391, 0.42508621060209057296952951163804},
 {0.023308867510000190714466386895980, 0.023308867510000190714466386895980},
 {0.023308867510000190714466386895980, 0.95338226497999961857106722620804},
 {0.95338226497999961857106722620804, 0.023308867510000190714466386895980},
 {0.62830740021349255642083766607883, 0.22376697357697300622568649026820},
 {0.62830740021349255642083766607883, 0.14792562620953443735347584365296},
 {0.22376697357697300622568649026820, 0.62830740021349255642083766607883},
 {0.22376697357697300622568649026820, 0.14792562620953443735347584365296},
 {0.14792562620953443735347584365296, 0.62830740021349255642083766607883},
 {0.14792562620953443735347584365296, 0.22376697357697300622568649026820},
 {0.61131382618139764891875500225390, 0.35874014186443146457815530072385},
 {0.61131382618139764891875500225390, 0.02994603195417088650308969702225},
 {0.35874014186443146457815530072385, 0.61131382618139764891875500225390},
 {0.35874014186443146457815530072385, 0.02994603195417088650308969702225},
 {0.02994603195417088650308969702225, 0.61131382618139764891875500225390},
 {0.02994603195417088650308969702225, 0.35874014186443146457815530072385},
 {0.82107206998562937337354441347218, 0.14329537042686714530585663061732},
 {0.82107206998562937337354441347218, 0.03563255958750348132059895591050},
 {0.14329537042686714530585663061732, 0.82107206998562937337354441347218},
 {0.14329537042686714530585663061732, 0.03563255958750348132059895591050},
 {0.03563255958750348132059895591050, 0.82107206998562937337354441347218},
 {0.03563255958750348132059895591050, 0.14329537042686714530585663061732}};

static const DOUBLE Quadrature2D_Triangle_P10_N25a_W[] =
{0.0399472523706198539156235226066932,
 0.0355619011161886673196456436993290,
 0.0355619011161886673196456436993290,
 0.0355619011161886673196456436993290,
 4.11190934523209775932331018123594e-3,
 4.11190934523209775932331018123594e-3,
 4.11190934523209775932331018123594e-3,
 0.0227152961480850090035368146219665,
 0.0227152961480850090035368146219665,
 0.0227152961480850090035368146219665,
 0.0227152961480850090035368146219665,
 0.0227152961480850090035368146219665,
 0.0227152961480850090035368146219665,
 0.0186799281171526384131182495009876,
 0.0186799281171526384131182495009876,
 0.0186799281171526384131182495009876,
 0.0186799281171526384131182495009876,
 0.0186799281171526384131182495009876,
 0.0186799281171526384131182495009876,
 0.0154433284422819943912565385023143,
 0.0154433284422819943912565385023143,
 0.0154433284422819943912565385023143,
 0.0154433284422819943912565385023143,
 0.0154433284422819943912565385023143,
 0.0154433284422819943912565385023143};

static QUADRATURE Quadrature2D_Triangle_P10_N25a = {
  /* Number of Gauss Points */
  25,
  /* Polynomial degree */
  10,
  /* Abscissae */
  Quadrature2D_Triangle_P10_N25a_GP,
  /* Weight */
  Quadrature2D_Triangle_P10_N25a_W
};

/* 25 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P10_N25b_GP[] =
{{0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.14216110105656438509216210319096, 0.14216110105656438509216210319096},
 {0.14216110105656438509216210319096, 0.71567779788687122981567579361808},
 {0.71567779788687122981567579361808, 0.14216110105656438509216210319096},
 {0.032055373216943512930984589336490, 0.032055373216943512930984589336490},
 {0.032055373216943512930984589336490, 0.93588925356611297413803082132702},
 {0.93588925356611297413803082132702, 0.032055373216943512930984589336490},
 {0.53005411892734402827709567394569, 0.32181299528883542122509756098605},
 {0.53005411892734402827709567394569, 0.14813288578382055049780676506826},
 {0.32181299528883542122509756098605, 0.53005411892734402827709567394569},
 {0.32181299528883542122509756098605, 0.14813288578382055049780676506826},
 {0.14813288578382055049780676506826, 0.53005411892734402827709567394569},
 {0.14813288578382055049780676506826, 0.32181299528883542122509756098605},
 {0.60123332868345924545474289345869, 0.36914678182781098691142083711527},
 {0.60123332868345924545474289345869, 0.02961988948872976763383626942604},
 {0.36914678182781098691142083711527, 0.60123332868345924545474289345869},
 {0.36914678182781098691142083711527, 0.02961988948872976763383626942604},
 {0.02961988948872976763383626942604, 0.60123332868345924545474289345869},
 {0.02961988948872976763383626942604, 0.36914678182781098691142083711527},
 {0.80793060092287906507994990288174, 0.16370173373718249566961434154012},
 {0.80793060092287906507994990288174, 0.02836766533993843925043575557813},
 {0.16370173373718249566961434154012, 0.80793060092287906507994990288174},
 {0.16370173373718249566961434154012, 0.02836766533993843925043575557813},
 {0.02836766533993843925043575557813, 0.80793060092287906507994990288174},
 {0.02836766533993843925043575557813, 0.16370173373718249566961434154012}};

static const DOUBLE Quadrature2D_Triangle_P10_N25b_W[] =
{0.0408716645731429832140593424920888,
 0.0229789818023723640068939548162739,
 0.0229789818023723640068939548162739,
 0.0229789818023723640068939548162739,
 6.67648440657478313778648919953432e-3,
 6.67648440657478313778648919953432e-3,
 6.67648440657478313778648919953432e-3,
 0.0319524531982120227164493668813266,
 0.0319524531982120227164493668813266,
 0.0319524531982120227164493668813266,
 0.0319524531982120227164493668813266,
 0.0319524531982120227164493668813266,
 0.0319524531982120227164493668813266,
 0.0170923240814797143143457920206711,
 0.0170923240814797143143457920206711,
 0.0170923240814797143143457920206711,
 0.0170923240814797143143457920206711,
 0.0170923240814797143143457920206711,
 0.0170923240814797143143457920206711,
 0.0126488788536441921945213953414166,
 0.0126488788536441921945213953414166,
 0.0126488788536441921945213953414166,
 0.0126488788536441921945213953414166,
 0.0126488788536441921945213953414166,
 0.0126488788536441921945213953414166};

static QUADRATURE Quadrature2D_Triangle_P10_N25b = {
  /* Number of Gauss Points */
  25,
  /* Polynomial degree */
  10,
  /* Abscissae */
  Quadrature2D_Triangle_P10_N25b_GP,
  /* Weight */
  Quadrature2D_Triangle_P10_N25b_W
};

/* ---- Polynomial degree 11 --------------------------------------------*/

/* 28 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P11_N28_GP[] =
{{0.858870281282636704039173938058347, 0.141129718717363295960826061941652},
 {0.858870281282636704039173938058347, 0.0},
 {0.141129718717363295960826061941652, 0.858870281282636704039173938058347},
 {0.141129718717363295960826061941652, 0.0},
 {0.0, 0.858870281282636704039173938058347},
 {0.0, 0.141129718717363295960826061941652},
 {0.333333333333333333333333333333333, 0.333333333333333333333333333333333},
 {0.025989140928287395260032485498841, 0.025989140928287395260032485498841},
 {0.025989140928287395260032485498841, 0.94802171814342520947993502900232},
 {0.94802171814342520947993502900232, 0.025989140928287395260032485498841},
 {0.094287502647922495630569776275405, 0.094287502647922495630569776275405},
 {0.094287502647922495630569776275405, 0.81142499470415500873886044744919},
 {0.81142499470415500873886044744919, 0.094287502647922495630569776275405},
 {0.49463677501721381374163260230644, 0.49463677501721381374163260230644},
 {0.49463677501721381374163260230644, 0.01072644996557237251673479538713},
 {0.01072644996557237251673479538713, 0.49463677501721381374163260230644},
 {0.20734338261451133345293402411297, 0.20734338261451133345293402411297},
 {0.20734338261451133345293402411297, 0.58531323477097733309413195177407},
 {0.58531323477097733309413195177407, 0.20734338261451133345293402411297},
 {0.43890780570049209506106538163613, 0.43890780570049209506106538163613},
 {0.43890780570049209506106538163613, 0.12218438859901580987786923672775},
 {0.12218438859901580987786923672775, 0.43890780570049209506106538163613},
 {0.67793765488259040154212614118875, 0.044841677589130443309052391468801},
 {0.67793765488259040154212614118875, 0.27722066752827915514882146734245},
 {0.044841677589130443309052391468801, 0.67793765488259040154212614118875},
 {0.044841677589130443309052391468801, 0.27722066752827915514882146734245},
 {0.27722066752827915514882146734245, 0.67793765488259040154212614118875},
 {0.27722066752827915514882146734245, 0.044841677589130443309052391468801}};

static const DOUBLE Quadrature2D_Triangle_P11_N28_W[] =
{3.68119189165027713212944752369032e-3,
 3.68119189165027713212944752369032e-3,
 3.68119189165027713212944752369032e-3,
 3.68119189165027713212944752369032e-3,
 3.68119189165027713212944752369032e-3,
 3.68119189165027713212944752369032e-3,
 0.0439886505811161193990465846607278,
 4.37215577686801152475821439991262e-3,
 4.37215577686801152475821439991262e-3,
 4.37215577686801152475821439991262e-3,
 0.0190407859969674687575121697178070,
 0.0190407859969674687575121697178070,
 0.0190407859969674687575121697178070,
 9.42772402806564602923839129555767e-3,
 9.42772402806564602923839129555767e-3,
 9.42772402806564602923839129555767e-3,
 0.0360798487723697630620149942932315,
 0.0360798487723697630620149942932315,
 0.0360798487723697630620149942932315,
 0.0346645693527679499208828254519072,
 0.0346645693527679499208828254519072,
 0.0346645693527679499208828254519072,
 0.0205281577146442833208261574536469,
 0.0205281577146442833208261574536469,
 0.0205281577146442833208261574536469,
 0.0205281577146442833208261574536469,
 0.0205281577146442833208261574536469,
 0.0205281577146442833208261574536469};

static QUADRATURE Quadrature2D_Triangle_P11_N28 = {
  /* Number of Gauss Points */
  28,
  /* Polynomial degree */
  11,
  /* Abscissae */
  Quadrature2D_Triangle_P11_N28_GP,
  /* Weight */
  Quadrature2D_Triangle_P11_N28_W
};

/* ---- Polynomial degree 11 --------------------------------------------*/

/* 28 inner Gauss points, positive weights */
static const DOUBLE_VECTOR_3D Quadrature2D_Triangle_P12_N33_GP[] =
{{0.02356522045239,0.488217389773805},
 {0.488217389773805,0.02356522045239},
 {0.488217389773805,0.488217389773805},
 {0.43972439229446,0.43972439229446},
 {0.43972439229446,0.120551215411079},
 {0.120551215411079,0.43972439229446},
 {0.271210385012116,0.271210385012116},
 {0.271210385012116,0.457579229975768},
 {0.457579229975768,0.271210385012116},
 {0.127576145541586,0.127576145541586},
 {0.127576145541586,0.7448477089168279},
 {0.7448477089168279,0.127576145541586},
 {0.02131735045321,0.02131735045321},
 {0.02131735045321,0.9573652990935799},
 {0.9573652990935799,0.02131735045321},
 {0.115343494534698,0.275713269685514},
 {0.115343494534698,0.6089432357797879},
 {0.275713269685514,0.115343494534698},
 {0.275713269685514,0.6089432357797879},
 {0.6089432357797879,0.115343494534698},
 {0.6089432357797879,0.275713269685514},
 {0.022838332222257,0.28132558098994},
 {0.022838332222257,0.6958360867878031},
 {0.28132558098994,0.022838332222257},
 {0.28132558098994,0.6958360867878031},
 {0.6958360867878031,0.022838332222257},
 {0.6958360867878031,0.28132558098994},
 {0.02573405054833,0.116251915907597},
 {0.02573405054833,0.858014033544073},
 {0.116251915907597,0.02573405054833},
 {0.116251915907597,0.858014033544073},
 {0.858014033544073,0.02573405054833},
 {0.858014033544073,0.116251915907597}};

static const DOUBLE Quadrature2D_Triangle_P12_N33_W[] =
{0.025731066440455,
 0.025731066440455,
 0.025731066440455,
 0.043692544538038,
 0.043692544538038,
 0.043692544538038,
 0.062858224217885,
 0.062858224217885,
 0.062858224217885,
 0.034796112930709,
 0.034796112930709,
 0.034796112930709,
 0.006166261051559,
 0.006166261051559,
 0.006166261051559,
 0.040371557766381,
 0.040371557766381,
 0.040371557766381,
 0.040371557766381,
 0.040371557766381,
 0.040371557766381,
 0.022356773202303,
 0.022356773202303,
 0.022356773202303,
 0.022356773202303,
 0.022356773202303,
 0.022356773202303,
 0.017316231108659,
 0.017316231108659,
 0.017316231108659,
 0.017316231108659,
 0.017316231108659,
 0.017316231108659};

static QUADRATURE Quadrature2D_Triangle_P12_N33 = {
  /* Number of Gauss Points */
  33,
  /* Polynomial degree */
  12,
  /* Abscissae */
  Quadrature2D_Triangle_P12_N33_GP,
  /* Weight */
  Quadrature2D_Triangle_P12_N33_W
};

/******** End of GaussQuadratureRule functions *****************************/


static const DOUBLE_VECTOR_3D Quadrature2D40_l[] = {{0.0, 0.0},{1.0, 0.0},{1.0, 1.0},{0.0, 1.0}};
static const DOUBLE Quadrature2D40_w[] = {0.25,0.25,0.25,0.25};
static QUADRATURE Quadrature2D40 = {4, 0, Quadrature2D40_l, Quadrature2D40_w};

static const DOUBLE_VECTOR_3D Quadrature2D42_l[] = {{0.211324865405187, 0.211324865405187},
                                                    {0.788675134594813, 0.211324865405187},
                                                    {0.211324865405187, 0.788675134594813},
                                                    {0.788675134594813, 0.788675134594813}};
static const DOUBLE Quadrature2D42_w[] = {0.25,0.25,0.25,0.25};
static QUADRATURE Quadrature2D42 = {4, 2, Quadrature2D42_l, Quadrature2D42_w};

static const DOUBLE_VECTOR_3D Quadrature2D44_l[] = {
  {0.112701665379258, 0.112701665379258},
  {0.5, 0.112701665379258},
  {0.887298334620742, 0.112701665379258},
  {0.112701665379258, 0.5},
  {0.5, 0.5},
  {0.887298334620742, 0.5},
  {0.112701665379258, 0.887298334620742},
  {0.5, 0.887298334620742},
  {0.887298334620742, 0.887298334620742}
};
static const DOUBLE Quadrature2D44_w[] = {
  0.07716049382716,
  0.12345679012346,
  0.07716049382716,
  0.12345679012346,
  0.19753086419753,
  0.12345679012346,
  0.07716049382716,
  0.12345679012346,
  0.07716049382716
};
static QUADRATURE Quadrature2D44 = {9, 4, Quadrature2D44_l, Quadrature2D44_w};

static const DOUBLE_VECTOR_3D Quadrature3D40_l[] = {{0.25,0.25,0.25},
                                                    {0.1,0.1,0.4},
                                                    {0.1,0.4,0.1},
                                                    {0.4,0.1,0.1},
                                                    {0.1,0.4,0.4},
                                                    {0.4,0.1,0.4},
                                                    {0.4,0.4,0.1}};
static const DOUBLE Quadrature3D40_w[] = {0.142857142857143,0.142857142857143,0.142857142857143,0.142857142857143,
                                          0.142857142857143,0.142857142857143,0.142857142857143};
static QUADRATURE Quadrature3D40 = {7, 0, Quadrature3D40_l, Quadrature3D40_w};

static const DOUBLE_VECTOR_3D Quadrature3D41_l[] = {{0.25,0.25,0.25}};
static const DOUBLE Quadrature3D41_w[] = {1.0};
static QUADRATURE Quadrature3D41 = {1, 1, Quadrature3D41_l, Quadrature3D41_w};

static const DOUBLE_VECTOR_3D Quadrature3D42_l[] = {{0.58541020, 0.13819660, 0.13819660},
                                                    {0.13819660, 0.58541020, 0.13819660},
                                                    {0.13819660, 0.13819660, 0.58541020},
                                                    {0.13819660, 0.13819660, 0.13819660}};
static const DOUBLE Quadrature3D42_w[] = {0.25,0.25,0.25,0.25};
static QUADRATURE Quadrature3D42 = {4, 2, Quadrature3D42_l, Quadrature3D42_w};

static const DOUBLE_VECTOR_3D Quadrature3D43_l[] = {
  {0.0,0.0,0.0},
  {1.0,0.0,0.0},
  {0.0,1.0,0.0},
  {1.0,0.0,1.0},
  {0.333333333333,0.333333333333,0.0},
  {0.333333333333,0.0,0.333333333333},
  {0.0,0.333333333333,0.333333333333},
  {0.333333333333,0.333333333333,0.333333333333}
};
static const DOUBLE Quadrature3D43_w[] = {
  0.025,0.025,0.025,0.025,0.225,0.225,0.225,0.225
};
static QUADRATURE Quadrature3D43 = {8, 3, Quadrature3D43_l, Quadrature3D43_w};

/* Strout 1971 */

#define s_1 0.091971078   /* (7 - sq(15) ) / 34 */
#define s_2 0.31979363    /* (7 + sq(15) ) / 34 */
#define t_1 0.72408677    /* (13 + 3*sq(15) ) / 34 */
#define t_2 0.040619117   /* (13 - 3*sq(15) ) / 34 */
#define u   0.056350833   /* (10 - 2*sq(15) ) / 40 */
#define v   0.44364917    /* (10 + 2*sq(15) ) / 40 */
#define A   0.11851852    /* 16 / 135 */
#define B_1 0.071937084   /* (2665 - 14*sq(15) ) / 37800 */
#define B_2 0.069068207   /* (2665 - 14*sq(15) ) / 37800 */
#define C   0.052910053   /* 20 / 378 */

static const DOUBLE_VECTOR_3D Quadrature3D45_l[] = {
  {0.25,0.25,0.25},
  {s_1,s_1,s_1},
  {t_1,s_1,s_1},
  {s_1,t_1,s_1},
  {s_1,s_1,t_1},
  {s_2,s_2,s_2},
  {t_2,s_2,s_2},
  {s_2,t_2,s_2},
  {s_2,s_2,t_2},
  {v,u,u},
  {u,v,u},
  {u,u,v},
  {v,v,u},
  {v,u,v},
  {u,v,v}
};
static const DOUBLE Quadrature3D45_w[] = {
  A,B_1,B_1,B_1,B_1,B_2,B_2,B_2,B_2,C,C,C,C,C,C
};
static QUADRATURE Quadrature3D45 = {15, 5, Quadrature3D45_l, Quadrature3D45_w};

#undef s_1
#undef s_2
#undef t_1
#undef t_2
#undef u
#undef v
#undef A
#undef B_1
#undef B_2
#undef C

static const DOUBLE_VECTOR_3D Quadrature3D52_l[] = {{0.58541020, 0.72819660, 0.13819660},
                                                    {0.13819660, 0.72819660, 0.13819660},
                                                    {0.13819660, 0.27630920, 0.58541020},
                                                    {0.13819660, 0.27630920, 0.13819660},
                                                    {0.72819660, 0.13819660, 0.13819660},
                                                    {0.72819660, 0.58541020, 0.13819660},
                                                    {0.27630920, 0.13819660, 0.58541020},
                                                    {0.27630920, 0.13819660, 0.13819660}};
static const DOUBLE Quadrature3D52_w[] = {0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125};
static QUADRATURE Quadrature3D52 = {8, 2, Quadrature3D52_l, Quadrature3D52_w};

static const DOUBLE_VECTOR_3D Quadrature3D60_l[] = {{0.0, 0.0, 0.0},
                                                    {1.0, 0.0, 0.0},
                                                    {0.0, 1.0, 0.0},
                                                    {0.0, 0.0, 1.0},
                                                    {1.0, 0.0, 1.0},
                                                    {0.0, 1.0, 1.0}};
static const DOUBLE Quadrature3D60_w[] = {0.16666666666666666, 0.16666666666666666,
                                          0.16666666666666666, 0.16666666666666666,
                                          0.16666666666666666, 0.16666666666666666};
static QUADRATURE Quadrature3D60 = {6, 0, Quadrature3D60_l, Quadrature3D60_w};

static const DOUBLE_VECTOR_3D Quadrature3D62_l[] = {{0.66666666666666666, 0.16666666666666666, 0.211324865405187},
                                                    {0.16666666666666666, 0.66666666666666666, 0.211324865405187},
                                                    {0.16666666666666666, 0.16666666666666666, 0.211324865405187},
                                                    {0.66666666666666666, 0.16666666666666666, 0.788675134594813},
                                                    {0.16666666666666666, 0.66666666666666666, 0.788675134594813},
                                                    {0.16666666666666666, 0.16666666666666666, 0.788675134594813}};
static const DOUBLE Quadrature3D62_w[] = {0.16666666666666666, 0.16666666666666666,
                                          0.16666666666666666, 0.16666666666666666,
                                          0.16666666666666666, 0.16666666666666666};
static QUADRATURE Quadrature3D62 = {6, 2, Quadrature3D62_l, Quadrature3D62_w};

static const DOUBLE_VECTOR_3D Quadrature3D63_l[] = {{0.333333333333333, 0.333333333333333, 0.211324865405187},
                                                    {0.6, 0.2, 0.211324865405187},
                                                    {0.2, 0.6, 0.211324865405187},
                                                    {0.2, 0.2, 0.211324865405187},
                                                    {0.333333333333333, 0.333333333333333, 0.788675134594813},
                                                    {0.6, 0.2, 0.788675134594813},
                                                    {0.2, 0.6, 0.788675134594813},
                                                    {0.2, 0.2, 0.788675134594813}};
static const DOUBLE Quadrature3D63_w[] = {-0.28125, 0.2604166666666666, 0.2604166666666666, 0.2604166666666666,
                                          -0.28125, 0.2604166666666666, 0.2604166666666666, 0.2604166666666666};
static QUADRATURE Quadrature3D63 = {8, 3, Quadrature3D63_l, Quadrature3D63_w};

static const DOUBLE_VECTOR_3D Quadrature3D80_l[] = {{0.0, 0.0, 0.0},
                                                    {0.0, 0.0, 1.0},
                                                    {0.0, 1.0, 0.0},
                                                    {0.0, 1.0, 1.0},
                                                    {1.0, 0.0, 0.0},
                                                    {1.0, 0.0, 1.0},
                                                    {1.0, 1.0, 0.0},
                                                    {1.0, 1.0, 1.0}};
static const DOUBLE Quadrature3D80_w[] = {0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125};
static QUADRATURE Quadrature3D80 = {8, 0, Quadrature3D80_l, Quadrature3D80_w};

static const DOUBLE_VECTOR_3D Quadrature3D82_l[] = {{0.211324865405187, 0.211324865405187, 0.211324865405187},
                                                    {0.788675134594813, 0.211324865405187, 0.211324865405187},
                                                    {0.211324865405187, 0.788675134594813, 0.211324865405187},
                                                    {0.788675134594813, 0.788675134594813, 0.211324865405187},
                                                    {0.211324865405187, 0.211324865405187, 0.788675134594813},
                                                    {0.788675134594813, 0.211324865405187, 0.788675134594813},
                                                    {0.211324865405187, 0.788675134594813, 0.788675134594813},
                                                    {0.788675134594813, 0.788675134594813, 0.788675134594813}};
static const DOUBLE Quadrature3D82_w[] = {0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125};
static QUADRATURE Quadrature3D82 = {8, 2, Quadrature3D82_l, Quadrature3D82_w};

#define A_1 0.112701665379258
#define A_2 0.887298334620742
#define W_1 0.277777777777777
#define W_2 0.444444444444444

static const DOUBLE_VECTOR_3D Quadrature3D84_l[] = {
  {A_1,A_1,A_1},
  {0.5,A_1,A_1},
  {A_2,A_1,A_1},
  {A_1,0.5,A_1},
  {0.5,0.5,A_1},
  {A_2,0.5,A_1},
  {A_1,A_2,A_1},
  {0.5,A_2,A_1},
  {A_2,A_2,A_1},
  {A_1,A_1,0.5},
  {0.5,A_1,0.5},
  {A_2,A_1,0.5},
  {A_1,0.5,0.5},
  {0.5,0.5,0.5},
  {A_2,0.5,0.5},
  {A_1,A_2,0.5},
  {0.5,A_2,0.5},
  {A_2,A_2,0.5},
  {A_1,A_1,A_2},
  {0.5,A_1,A_2},
  {A_2,A_1,A_2},
  {A_1,0.5,A_2},
  {0.5,0.5,A_2},
  {A_2,0.5,A_2},
  {A_1,A_2,A_2},
  {0.5,A_2,A_2},
  {A_2,A_2,A_2}
};
static const DOUBLE Quadrature3D84_w[] =
{W_1*W_1*W_1,W_2*W_1*W_1,W_1*W_1*W_1,
 W_1*W_2*W_1,W_2*W_2*W_1,W_1*W_2*W_1,
 W_1*W_1*W_1,W_2*W_1*W_1,W_1*W_1*W_1,
 W_1*W_1*W_2,W_2*W_1*W_2,W_1*W_1*W_2,
 W_1*W_2*W_2,W_2*W_2*W_2,W_1*W_2*W_2,
 W_1*W_1*W_2,W_2*W_1*W_2,W_1*W_1*W_2,
 W_1*W_1*W_1,W_2*W_1*W_1,W_1*W_1*W_1,
 W_1*W_2*W_1,W_2*W_2*W_1,W_1*W_2*W_1,
 W_1*W_1*W_1,W_2*W_1*W_1,W_1*W_1*W_1};
static QUADRATURE Quadrature3D84 = {27, 4, Quadrature3D84_l, Quadrature3D84_w};

#undef A_1
#undef A_2
#undef W_1
#undef W_2


/****************************************************************************/
/*D
   GetQuadrature - providing a quadrature formula

   SYNOPSIS:
   QUADRATURE *GetQuadrature(INT dim, INT n, INT order);

   PARAMETERS:
   .  dim - dimension of the formular
   .  n - number of corners of the element
   .  order - order of approximation

   DESCRIPTION:
   This function returns a pointer to a quadrature formula.

   EXAMPLE:
   .vb
   QUADRATURE *quadrature;

   if ((quadrature = GetQuadrature(2,3,2)) == NULL)
          return(1);
   sum = 0.0;
   for (l=0; l<Q_NIP(quadrature); l++)
   {
    LOCAL_TO_GLOBAL(n,x,Q_LOCAL(quadrature,l),global);
    (*SourceFunc)(global,val);
    sum += val * Q_WEIGHT(quadrature,l);
   }
   sum = val * AreaOfTriangle;
   .ve

   RETURN VALUE:
   QUADRATURE *
   .n    pointer to quadrature
   .n    NULL if the quadrature formula cannot be found.
   D*/
/****************************************************************************/

QUADRATURE *GetQuadrature(INT dim, INT n, INT order)
{
  switch (dim)
  {
  case 1 :
    switch (order)
    {
    case 0 :
    case 1 : return(&Quadrature1D1);
    case 2 :
    case 3 : return(&Quadrature1D3);
    case 4 :
    case 5 : return(&Quadrature1D5);
    default : return(&Quadrature1D7);
    }
  case 2 :
    switch (n)
    {
    case 3 :
      switch (order)
      {
      case 1 : return(&Quadrature2D31);
      case 2 : return(&Quadrature2D32);
      case 3 : return(&Quadrature2D33);
      case 4 : return(&Quadrature2D34);
      default : return(&Quadrature2D35);
      }
    case 4 :
      switch (order)
      {
      case 0 : return(&Quadrature2D40);
      case 1 : return(&Quadrature2D42);
      case 2 : return(&Quadrature2D42);
      case 3 : return(&Quadrature2D44);
      case 4 : return(&Quadrature2D44);
      default : return(&Quadrature2D44);
      }
    }
  case 3 :
    switch (n)
    {
    case 4 :
      switch (order)
      {
      case 0 :  return(&Quadrature3D40);
      case 1 :  return(&Quadrature3D41);
      case 2 :  return(&Quadrature3D42);
      case 3 :  return(&Quadrature3D43);
      default : return(&Quadrature3D45);
      }
    case 5 : return(&Quadrature3D52);
    case 6 :
      switch (order)
      {
      case 0 :  return(&Quadrature3D60);
      default : return(&Quadrature3D62);
      }
    case 8 :
      switch (order)
      {
      case 0 : return(&Quadrature3D80);
      case 1 : return(&Quadrature3D82);
      case 2 : return(&Quadrature3D82);
      default : return(&Quadrature3D84);
      }
    }
  }
  return(NULL);
}


/****************************************************************************/
/*D
   GetQuadratureRule - providing a quadrature formula

   SYNOPSIS:
   QUADRATURE *GetQuadratureRule(INT dim, INT n, INT order);

   PARAMETERS:
   .  dim - dimension of the formular
   .  n - number of corners of the element
   .  order - order of approximation

   DESCRIPTION:
   This function returns a pointer to a quadrature formula.

   It is different from GetQuadrature in the case that the quadrature
   formula of order 'order' is not exactly available.  'GetQuadrature'
   just returns the highest order formula, GetQuadratureRule returns
   the formula of the smallest degree that integrates exactly until 'order'.

   EXAMPLE:
   .vb
   QUADRATURE *quadrature;

   if ((quadrature = GetQuadratureRule(2,3,2)) == NULL)
          return(1);
   sum = 0.0;
   for (l=0; l<Q_NIP(quadrature); l++)
   {
    LOCAL_TO_GLOBAL(n,x,Q_LOCAL(quadrature,l),global);
    (*SourceFunc)(global,val);
    sum += val * Q_WEIGHT(quadrature,l);
   }
   sum = val * AreaOfTriangle;
   .ve

   RETURN VALUE:
   QUADRATURE *
   .n    pointer to quadrature
   .n    NULL if the quadrature formula cannot be found.
   D*/
/****************************************************************************/

QUADRATURE *GetQuadratureRule(INT dim, INT n, INT order)
{
  switch (dim)
  {
  case 1 :
    switch (order)
    {
    case 0 :
    case 1 : return(&Quadrature1D1);
    case 2 :
    case 3 : return(&Quadrature1D3);
    case 4 :
    case 5 : return(&Quadrature1D5);
    case 6 :
    case 7 : return(&Quadrature1D7);
    case 8 :
    case 9 : return(&Quadrature1D9);
    case 10 :
    case 11 : return(&Quadrature1D11);
    case 12 :
    case 13 : return(&Quadrature1D13);
    case 14 :
    case 15 : return(&Quadrature1D15);
    case 16 :
    case 17 : return(&Quadrature1D17);
    case 18 :
    case 19 : return(&Quadrature1D19);
    case 20 :
    default : return(&Quadrature1D19);
    }
  case 2 :
    switch (n)
    {
    case 3 :
      switch (order)
      {
      case 0 :
      case 1 :       return(&Quadrature2D_Triangle_P1_N1);
      case 2 :       return(&Quadrature2D_Triangle_P2_N3b);
      case 3 :       return(&Quadrature2D_Triangle_P3_N4);
      case 4 :       return(&Quadrature2D_Triangle_P4_N6);
      case 5 :       return(&Quadrature2D_Triangle_P5_N7);
      case 6 :       return(&Quadrature2D_Triangle_P6_N12a);
      case 7 :       return(&Quadrature2D_Triangle_P7_N12);
      case 8 :       return(&Quadrature2D_Triangle_P8_N16);
      case 9 :       return(&Quadrature2D_Triangle_P9_N19);
      case 10 :      return(&Quadrature2D_Triangle_P10_N25a);
      case 11 :      return(&Quadrature2D_Triangle_P11_N28);
      case 12 :      return(&Quadrature2D_Triangle_P12_N33);
      default :      return(&Quadrature2D_Triangle_P12_N33);
      }
    case 4 :
      switch (order)
      {
      case 0 : return(&Quadrature2D40);
      case 1 : return(&Quadrature2D42);
      case 2 : return(&Quadrature2D42);
      case 3 : return(&Quadrature2D44);
      case 4 : return(&Quadrature2D44);
      default : return(&Quadrature2D44);
      }
    }
  case 3 :
    switch (n)
    {
    case 4 :
      switch (order)
      {
      case 0 :  return(&Quadrature3D40);
      case 1 :  return(&Quadrature3D41);
      case 2 :  return(&Quadrature3D42);
      case 3 :  return(&Quadrature3D43);
      default : return(&Quadrature3D45);
      }
    case 5 : return(&Quadrature3D52);
    case 6 :
      switch (order)
      {
      case 0 :  return(&Quadrature3D60);
      default : return(&Quadrature3D62);
      }
    case 8 :
      switch (order)
      {
      case 0 : return(&Quadrature3D80);
      case 1 : return(&Quadrature3D82);
      case 2 : return(&Quadrature3D82);
      default : return(&Quadrature3D84);
      }
    }
  }
  return(NULL);
}

INT GaussPoints(INT dim, INT n, INT order, DOUBLE_VECTOR *x, GAUSS_POINT *gp)
{
  DOUBLE Jdet,area;
  INT ip,nip;
  QUADRATURE *quadrature;

  AREA_OF_REF(n,area);

  if ((quadrature = GetQuadrature(dim,n,order)) == NULL)
    return(1);

  nip = Q_NIP(quadrature);
  for (ip=0; ip<nip; ip++, gp++)
  {
    V_DIM_COPY(Q_LOCAL(quadrature,ip),G_LOCAL(gp));
    LOCAL_TO_GLOBAL (n,x,G_LOCAL(gp),G_GLOBAL(gp));
    INVERSE_TRANSFORMATION(n,x,G_LOCAL(gp),G_JINV(gp),Jdet);
    G_WEIGHT(gp) = Q_WEIGHT(quadrature,ip) * area * ABS(Jdet);
  }

  return(nip);
}
